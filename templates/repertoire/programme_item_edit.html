{% extends 'staff/base.html' %}

{% block title %}Edit Item - Polyphonica{% endblock %}

{% block page_title %}Edit Programme Item{% endblock %}

{% block staff_content %}
<div class="max-w-2xl">
    <div class="bg-white rounded-xl shadow-sm p-6">
        <form method="post" class="space-y-6">
            {% csrf_token %}

            {% if item.item_type == 'piece' %}
            <div>
                <label class="block text-sm font-medium text-primary-700 mb-2">Piece</label>
                <select name="piece_id" class="w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500">
                    {% for piece in pieces %}
                    <option value="{{ piece.id }}" {% if item.piece_id == piece.id %}selected{% endif %}>
                        {{ piece.title }} - {{ piece.composer.name }} ({{ piece.duration_display }})
                    </option>
                    {% endfor %}
                </select>
            </div>
            {% else %}
            <div>
                <label class="block text-sm font-medium text-primary-700 mb-2">Title</label>
                <input type="text" name="title" value="{{ item.title }}" class="w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500">
            </div>

            <div>
                <label class="block text-sm font-medium text-primary-700 mb-2">Duration (minutes)</label>
                <input type="number" name="duration" value="{{ item.custom_duration }}" class="w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500">
            </div>

            {% if item.item_type == 'talk' %}
            <div>
                <label class="block text-sm font-medium text-primary-700 mb-2">Talk Text</label>
                <textarea name="talk_text" rows="6" class="w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500">{{ item.talk_text }}</textarea>
            </div>
            {% endif %}
            {% endif %}

            <div>
                <label class="block text-sm font-medium text-primary-700 mb-2">Internal Notes</label>
                <textarea name="notes" rows="2" class="w-full px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500">{{ item.notes }}</textarea>
            </div>

            <div class="flex gap-4 pt-4">
                <button type="submit" class="px-6 py-2 bg-accent-500 hover:bg-accent-600 text-white rounded-lg font-medium transition-colors">
                    Save Changes
                </button>
                <a href="{% url 'repertoire:programme_detail' item.programme.pk %}" class="px-6 py-2 bg-primary-100 hover:bg-primary-200 text-primary-700 rounded-lg font-medium transition-colors">
                    Cancel
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
