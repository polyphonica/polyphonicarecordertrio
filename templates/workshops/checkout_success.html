{% extends 'base.html' %}

{% block title %}Registration Confirmed - {{ workshop.title }} - Polyphonica Recorder Trio{% endblock %}

{% block structured_data %}
<!-- GA4 Conversion Tracking -->
<script>
    gtag('event', 'purchase', {
        transaction_id: '{{ registration.id }}',
        value: {{ registration.amount_paid }},
        currency: 'GBP',
        items: [{
            item_id: '{{ workshop.id }}',
            item_name: '{{ workshop.title|escapejs }}',
            item_category: 'workshop',
            price: {{ workshop.price }},
            quantity: 1
        }]
    });
</script>
{% endblock %}

{% block content %}
<section class="py-16 px-4">
    <div class="max-w-2xl mx-auto text-center">
        <!-- Success Icon -->
        <div class="mb-8">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full">
                <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
        </div>

        <h1 class="text-3xl md:text-4xl font-serif font-bold text-primary-900 mb-4">Registration Confirmed!</h1>

        <p class="text-lg text-primary-700 mb-8">
            You are registered for <strong>{{ workshop.title }}</strong>
        </p>

        <!-- Workshop Details -->
        <div class="bg-primary-50 rounded-xl p-6 mb-8 text-left">
            <h2 class="font-semibold text-primary-900 mb-4">Workshop Details</h2>
            <dl class="space-y-2">
                <div class="flex justify-between">
                    <dt class="text-primary-600">Date</dt>
                    <dd class="font-medium text-primary-900">{{ workshop.date|date:"l, j F Y" }}</dd>
                </div>
                <div class="flex justify-between">
                    <dt class="text-primary-600">Time</dt>
                    <dd class="font-medium text-primary-900">{{ workshop.start_time|time:"g:i A" }} - {{ workshop.end_time|time:"g:i A" }}</dd>
                </div>
                {% if workshop.is_in_person and workshop.venue_name %}
                <div class="flex justify-between">
                    <dt class="text-primary-600">Venue</dt>
                    <dd class="font-medium text-primary-900">{{ workshop.venue_name }}</dd>
                </div>
                {% endif %}
                <div class="flex justify-between border-t border-primary-200 pt-2 mt-2">
                    <dt class="text-primary-600">Amount Paid</dt>
                    <dd class="font-semibold text-primary-900">Â£{{ registration.amount_paid }}</dd>
                </div>
            </dl>
        </div>

        <p class="text-primary-600 mb-8">
            A confirmation email has been sent to <strong>{{ user.email }}</strong>
            {% if account_created %}
            <br><span class="text-sm">Your account login details have also been emailed to you.</span>
            {% endif %}
        </p>

        <a href="{% url 'workshops:detail' workshop.slug %}" class="inline-block px-6 py-3 bg-accent-500 hover:bg-accent-600 text-white font-semibold rounded-lg transition-colors">
            View Workshop Details
        </a>
    </div>
</section>
{% endblock %}
