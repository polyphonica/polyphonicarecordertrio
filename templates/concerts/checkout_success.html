{% extends 'base.html' %}

{% block title %}Tickets Confirmed - {{ concert.title }} - Polyphonica Recorder Trio{% endblock %}

{% block structured_data %}
<!-- GA4 Conversion Tracking -->
<script>
    gtag('event', 'purchase', {
        transaction_id: '{{ order.id }}',
        value: {{ order.total_price }},
        currency: 'GBP',
        items: [{
            item_id: '{{ concert.id }}',
            item_name: '{{ concert.title|escapejs }}',
            item_category: 'concert_ticket',
            price: {{ order.unit_price }},
            quantity: {{ order.quantity }}
        }]
    });
</script>
{% endblock %}

{% block content %}
<section class="py-16 px-4">
    <div class="max-w-2xl mx-auto text-center">
        <!-- Success Icon -->
        <div class="mb-8">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-green-100 rounded-full">
                <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
        </div>

        <h1 class="text-3xl md:text-4xl font-serif font-bold text-primary-900 mb-4">Tickets Confirmed!</h1>

        <p class="text-lg text-primary-700 mb-8">
            Your {{ order.quantity }} ticket{% if order.quantity > 1 %}s{% endif %} for <strong>{{ concert.title }}</strong> {% if order.quantity > 1 %}have{% else %}has{% endif %} been booked.
        </p>

        <!-- Concert Details -->
        <div class="bg-primary-50 rounded-xl p-6 mb-8 text-left">
            <h2 class="font-semibold text-primary-900 mb-4">Concert Details</h2>
            <dl class="space-y-2">
                <div class="flex justify-between">
                    <dt class="text-primary-600">Date</dt>
                    <dd class="font-medium text-primary-900">{{ concert.date|date:"l, j F Y" }}</dd>
                </div>
                <div class="flex justify-between">
                    <dt class="text-primary-600">Time</dt>
                    <dd class="font-medium text-primary-900">{{ concert.time|time:"g:i A" }}</dd>
                </div>
                <div class="flex justify-between">
                    <dt class="text-primary-600">Venue</dt>
                    <dd class="font-medium text-primary-900">{{ concert.venue_name }}</dd>
                </div>
                <div class="flex justify-between">
                    <dt class="text-primary-600">Tickets</dt>
                    <dd class="font-medium text-primary-900">{{ order.quantity }}x {{ order.get_ticket_type_display }}</dd>
                </div>
                <div class="flex justify-between border-t border-primary-200 pt-2 mt-2">
                    <dt class="text-primary-600">Total Paid</dt>
                    <dd class="font-semibold text-primary-900">Â£{{ order.total_price }}</dd>
                </div>
            </dl>
        </div>

        <p class="text-primary-600 mb-8">
            A confirmation email has been sent to <strong>{{ order.email }}</strong>
        </p>

        <a href="{% url 'concerts:detail' concert.slug %}" class="inline-block px-6 py-3 bg-accent-500 hover:bg-accent-600 text-white font-semibold rounded-lg transition-colors">
            View Concert Details
        </a>
    </div>
</section>
{% endblock %}
